<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-workshop/build-rag-app/5-cheat-script" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">üõ†Ô∏è Build Script | MongoDB-RAG</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mongodb-developer.github.io/mongodb-rag/docs/workshop/build-rag-app/5-cheat-script"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="üõ†Ô∏è Build Script | MongoDB-RAG"><meta data-rh="true" name="description" content="Build Script"><meta data-rh="true" property="og:description" content="Build Script"><link data-rh="true" rel="canonical" href="https://mongodb-developer.github.io/mongodb-rag/docs/workshop/build-rag-app/5-cheat-script"><link data-rh="true" rel="alternate" href="https://mongodb-developer.github.io/mongodb-rag/docs/workshop/build-rag-app/5-cheat-script" hreflang="en"><link data-rh="true" rel="alternate" href="https://mongodb-developer.github.io/mongodb-rag/docs/workshop/build-rag-app/5-cheat-script" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/mongodb-rag/blog/rss.xml" title="MongoDB-RAG RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mongodb-rag/blog/atom.xml" title="MongoDB-RAG Atom Feed"><link rel="stylesheet" href="/mongodb-rag/assets/css/styles.d2f703fb.css">
<script src="/mongodb-rag/assets/js/runtime~main.0cb88807.js" defer="defer"></script>
<script src="/mongodb-rag/assets/js/main.b3bb06cc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mongodb-rag/"><b class="navbar__title text--truncate">MongoDB-RAG</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mongodb-rag/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/mongodb-rag/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/mongodb-rag/chatbot">ü¶â Owlbert</a><a href="https://github.com/mongodb-developer/mongodb-rag" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mongodb-rag/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mongodb-rag/docs/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mongodb-rag/docs/usage">Usage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mongodb-rag/docs/cli-reference">CLI Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/mongodb-rag/docs/examples/basic-example">Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mongodb-rag/docs/examples/basic-example">Basic Example</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mongodb-rag/docs/examples/advanced-example">Advanced Example</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mongodb-rag/docs/create-rag-app">Create RAG App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mongodb-rag/docs/api-reference">API Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/mongodb-rag/docs/workshop/Introduction/introduction">Workshop</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mongodb-rag/docs/workshop/Introduction/introduction">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mongodb-rag/docs/workshop/mongodb-atlas/1-what-is-mongodb">MongoDB Atlas</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mongodb-rag/docs/workshop/RAG-Concepts/rag-concepts">RAG Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mongodb-rag/docs/workshop/MongoDB-RAG/introduction">MongoDB RAG</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/mongodb-rag/docs/workshop/build-rag-app/build-rag-app">Building the RAG App</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mongodb-rag/docs/workshop/build-rag-app/build-rag-app">üëê Building a RAG Application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mongodb-rag/docs/workshop/build-rag-app/2-ingest-documents">2 Ingest Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mongodb-rag/docs/workshop/build-rag-app/4-integrate-llm">4 Integrate Llm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mongodb-rag/docs/workshop/build-rag-app/5-cheat-script">üõ†Ô∏è Build Script</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mongodb-rag/docs/workshop/advanced-techniques/1-introduction">Advanced Techniques</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mongodb-rag/docs/workshop/production-deployment/production-deployment">Production Deployment</a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mongodb-rag/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Workshop</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Building the RAG App</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">üõ†Ô∏è Build Script</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>üõ†Ô∏è Build Script</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-script">Build Script<a href="#build-script" class="hash-link" aria-label="Direct link to Build Script" title="Direct link to Build Script">‚Äã</a></h2>
<p>Use this script to build the directory structure and populate some of the files you&#x27;ll need to get started.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create the directory structure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p rag-workshop/{data/articles,src/utils,tests}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create package.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/package.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot;: &quot;rag-workshop&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;description&quot;: &quot;RAG application workshop with MongoDB Atlas&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;main&quot;: &quot;src/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;scripts&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;start&quot;: &quot;node src/index.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;ingest&quot;: &quot;node src/ingest.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;search&quot;: &quot;node src/search.js&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;test&quot;: &quot;jest&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;dependencies&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;dotenv&quot;: &quot;^16.3.1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;express&quot;: &quot;^4.18.2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;mongodb-rag&quot;: &quot;^0.53.0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;openai&quot;: &quot;^4.10.0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;fs-extra&quot;: &quot;^11.1.1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;devDependencies&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;jest&quot;: &quot;^29.6.2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create .env file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/.env</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MONGODB_URI=your_mongodb_connection_string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EMBEDDING_API_KEY=your_openai_api_key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MONGODB_DATABASE_NAME=your_database_name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MONGODB_COLLECTION_NAME=your_collection_name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create sample data files</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/data/articles/mongodb-atlas.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MongoDB Atlas: The Cloud Database Service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MongoDB Atlas is a fully-managed cloud database service developed by MongoDB. It handles all the complexity of deploying, managing, and healing your deployments on the cloud service provider of your choice (AWS, Azure, and GCP).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Key Features</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Automated Deployment and Management</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MongoDB Atlas automates deployment, maintenance, and scaling. You can deploy a cluster with a few clicks or API calls.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Security</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MongoDB Atlas provides multiple layers of security for your database:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Network isolation with VPC peering</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- IP whitelisting</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Advanced authentication</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Field-level encryption</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- RBAC (Role-Based Access Control)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- LDAP integration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Monitoring and Alerts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The service includes built-in monitoring tools and customizable alerts based on over a dozen different metrics.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Automated Backups</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Continuous backups with point-in-time recovery ensure your data is protected.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Scaling Options</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Scale up or down without application downtime. Auto-scaling provisions storage capacity automatically.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Global Clusters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Create globally distributed clusters that route data to the closest available region to minimize latency.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Integrations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MongoDB Atlas integrates with popular services and tools:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- AWS services (Lambda, SageMaker, etc.)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Google Cloud (Firebase, DataFlow, etc.)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Microsoft Azure services</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Kafka</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Kubernetes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Atlas Vector Search</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MongoDB Atlas Vector Search enables you to build vector search applications by storing embeddings and performing k-nearest neighbor (k-NN) search.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Key capabilities include:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Store vector embeddings along with your operational data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Build semantic search applications</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Power recommendation engines</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Implement AI-powered applications</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/data/articles/rag-overview.md</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Retrieval-Augmented Generation (RAG): An Overview</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Retrieval-Augmented Generation (RAG) is an AI framework that enhances large language models (LLMs) by retrieving relevant information from external knowledge sources to ground the model&#x27;s responses in factual, up-to-date information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## How RAG Works</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The RAG process typically consists of three main stages:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1. **Retrieval**: The system queries a knowledge base to find information relevant to the input prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2. **Augmentation**: Retrieved information is added to the context provided to the LLM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">3. **Generation**: The LLM generates a response based on both the prompt and the retrieved information</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Benefits of RAG</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Retrieval-Augmented Generation offers several advantages:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Reduced Hallucinations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">By grounding responses in retrieved facts, RAG significantly reduces the tendency of LLMs to generate plausible-sounding but incorrect information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Up-to-date Information</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RAG systems can access recent information beyond the LLM&#x27;s training cutoff date, keeping responses current.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Domain Specialization</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RAG enables general-purpose LLMs to provide expert-level responses in specialized domains by retrieving domain-specific information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Transparency and Attribution</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Information sources can be tracked and cited, improving transparency and trustworthiness.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Cost Efficiency</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Retrieving information can be more efficient than training ever-larger models to memorize more facts.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Implementation Considerations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">When implementing RAG, several factors must be considered:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Knowledge Base Design</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The structure, format, and organization of the knowledge base significantly impact retrieval effectiveness.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Embedding Strategy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">How documents are converted to vector embeddings affects search quality.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Chunking Approach</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The method used to divide documents into chunks can impact retrieval precision.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Retrieval Algorithms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Different retrieval methods (BM25, vector search, hybrid approaches) have varying effectiveness depending on the use case.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Context Window Management</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Efficiently using the LLM&#x27;s context window is essential for complex queries requiring multiple retrieved documents.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Common Challenges</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RAG implementations often face several challenges:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Balancing retrieval precision and recall</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Handling contradictory information from multiple sources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Managing context window limitations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Addressing retrieval latency in real-time applications</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/data/qa-pairs.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;question&quot;: &quot;What is MongoDB Atlas?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expected_source&quot;: &quot;mongodb-atlas.md&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;question&quot;: &quot;What security features does MongoDB Atlas offer?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expected_source&quot;: &quot;mongodb-atlas.md&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;question&quot;: &quot;How does RAG reduce hallucinations?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expected_source&quot;: &quot;rag-overview.md&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;question&quot;: &quot;What are the three main stages of RAG?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expected_source&quot;: &quot;rag-overview.md&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;question&quot;: &quot;What is Atlas Vector Search used for?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expected_source&quot;: &quot;mongodb-atlas.md&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create configuration file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/src/config.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">require(&#x27;dotenv&#x27;).config();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">module.exports = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mongodb: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uri: process.env.MONGODB_URI,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    database: process.env.MONGODB_DATABASE_NAME,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    collection: process.env.MONGODB_COLLECTION_NAME</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  embedding: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    provider: process.env.EMBEDDING_PROVIDER || &#x27;openai&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    apiKey: process.env.EMBEDDING_API_KEY,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    model: process.env.EMBEDDING_MODEL || &#x27;text-embedding-3-small&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dimensions: 1536</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  search: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    maxResults: 5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    minScore: 0.7,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    returnSources: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create document ingestion script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/src/ingest.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const fs = require(&#x27;fs-extra&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const path = require(&#x27;path&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const { MongoRAG, Chunker } = require(&#x27;mongodb-rag&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const config = require(&#x27;./config&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Initialize MongoRAG</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const rag = new MongoRAG({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mongoUrl: config.mongodb.uri,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  database: config.mongodb.database,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  collection: config.mongodb.collection,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  embedding: config.embedding</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create a chunker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const chunker = new Chunker({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  strategy: config.chunking.strategy,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  maxChunkSize: config.chunking.maxChunkSize,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  overlap: config.chunking.overlap</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Function to read and process markdown files</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">async function ingestMarkdownFiles(directory) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Get all markdown files</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const files = await fs.readdir(directory);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const markdownFiles = files.filter(file =&gt; file.endsWith(&#x27;.md&#x27;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(\`Found \${markdownFiles.length} markdown files to process\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Process each file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for (const filename of markdownFiles) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const filePath = path.join(directory, filename);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const content = await fs.readFile(filePath, &#x27;utf-8&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      // Create document object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const document = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        id: path.basename(filename, &#x27;.md&#x27;),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        content: content,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        metadata: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          source: filename,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          type: &#x27;markdown&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          created: new Date().toISOString(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          filename: filename</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(\`Processing \${filename}...\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      // Chunk the document</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const chunks = await chunker.chunkDocument(document);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(\`Created \${chunks.length} chunks from \${filename}\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      // Ingest the chunks</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const result = await rag.ingestBatch(chunks);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(\`Ingested \${result.processed} chunks from \${filename}\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(&#x27;Document ingestion complete!&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(&#x27;Error ingesting documents:&#x27;, error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    await rag.close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Main function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">async function main() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  const articlesDir = path.join(__dirname, &#x27;../data/articles&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(&#x27;Starting document ingestion...&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`Using \${config.chunking.strategy} chunking strategy\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`Max chunk size: \${config.chunking.maxChunkSize} characters\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`Chunk overlap: \${config.chunking.overlap} characters\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  await rag.connect();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  await ingestMarkdownFiles(articlesDir);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Run the ingestion process</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">main().catch(console.error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create vector search script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/src/search.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const { MongoRAG } = require(&#x27;mongodb-rag&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const config = require(&#x27;./config&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Initialize MongoRAG</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const rag = new MongoRAG({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mongoUrl: config.mongodb.uri,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  database: config.mongodb.database,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  collection: config.mongodb.collection,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  embedding: config.embedding,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  search: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    maxResults: config.search.maxResults,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    minScore: config.search.minScore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Search for documents relevant to a query</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @param {string} query - The search query</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @param {Object} options - Search options</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @returns {Promise&lt;Array&gt;} - Search results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">async function searchDocuments(query, options = {}) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    await rag.connect();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(\`Searching for: &quot;\${query}&quot;\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const results = await rag.search(query, {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      maxResults: options.maxResults || config.search.maxResults,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      filter: options.filter || {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Post-process results if needed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const processedResults = results.map(result =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      // Add source document if returnSources is enabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      if (config.search.returnSources) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          ...result,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          source: result.metadata?.filename || &#x27;unknown&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      return result;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return processedResults;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(&#x27;Search error:&#x27;, error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    throw error;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    await rag.close();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Export for use in other modules</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">module.exports = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  searchDocuments</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// If run directly, perform a test search</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if (require.main === module) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  const testQuery = process.argv[2] || &#x27;What is MongoDB Atlas?&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  searchDocuments(testQuery)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .then(results =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(\`Found \${results.length} results:\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      results.forEach((result, i) =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        console.log(\`\nResult \${i+1} (score: \${result.score.toFixed(4)}):\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        console.log(\`Source: \${result.source}\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        console.log(\`Content: \${result.content.substring(0, 150)}...\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .catch(console.error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create LLM response generation script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/src/generate.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const { OpenAI } = require(&#x27;openai&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const config = require(&#x27;./config&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const { searchDocuments } = require(&#x27;./search&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Initialize OpenAI client</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const openai = new OpenAI({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  apiKey: config.llm.apiKey</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * Generate a response using RAG</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @param {string} query - User query</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @param {Object} options - Generation options</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @returns {Promise&lt;Object&gt;} - Generated response and metadata</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">async function generateResponse(query, options = {}) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Step 1: Retrieve relevant documents</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const searchResults = await searchDocuments(query, {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      maxResults: options.maxResults || 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (searchResults.length === 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      return {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        answer: &quot;I couldn&#x27;t find any relevant information to answer your question.&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        sources: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Step 2: Format context from retrieved documents</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const context = searchResults</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      .map(result =&gt; \`Source: \${result.source}\\nContent: \${result.content}\`)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      .join(&#x27;\\n\\n&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Step 3: Create prompt with context</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const messages = [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        role: &#x27;system&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        content: \`You are a helpful assistant. Answer the user&#x27;s question based ONLY on the provided context. </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 If the context doesn&#x27;t contain relevant information, say &quot;I don&#x27;t have enough information to answer that question.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 Always cite your sources at the end of your answer.\`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        role: &#x27;user&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        content: \`Context:\\n\${context}\\n\\nQuestion: \${query}\`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Step 4: Generate response using LLM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const completion = await openai.chat.completions.create({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      model: config.llm.model,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      messages: messages,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      temperature: options.temperature || 0.3,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      max_tokens: options.maxTokens || 500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Step 5: Return formatted response with sources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      answer: completion.choices[0].message.content,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      sources: searchResults.map(result =&gt; ({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source: result.source,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score: result.score</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(&#x27;Error generating response:&#x27;, error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    throw error;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Export for use in other modules</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">module.exports = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  generateResponse</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// If run directly, perform a test generation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if (require.main === module) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  const testQuery = process.argv[2] || &#x27;What are the security features of MongoDB Atlas?&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  generateResponse(testQuery)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .then(response =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(&#x27;\\nü§ñ Generated Answer:&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(response.answer);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      console.log(&#x27;\\nüìö Sources:&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      response.sources.forEach((source, i) =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        console.log(\`\${i+1}. \${source.source} (relevance: \${source.score.toFixed(4)})\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    .catch(console.error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create main application script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/src/index.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const express = require(&#x27;express&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const fs = require(&#x27;fs-extra&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const path = require(&#x27;path&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const { generateResponse } = require(&#x27;./generate&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const { searchDocuments } = require(&#x27;./search&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const config = require(&#x27;./config&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Initialize Express app</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const app = express();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.use(express.json());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.use(express.urlencoded({ extended: true }));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Health check endpoint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.get(&#x27;/healthz&#x27;, (req, res) =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  res.status(200).send(&#x27;OK&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Search endpoint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.get(&#x27;/api/search&#x27;, async (req, res) =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const { query, maxResults } = req.query;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!query) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      return res.status(400).json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error: &#x27;Missing required parameter: query&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const results = await searchDocuments(query, {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      maxResults: maxResults ? parseInt(maxResults) : undefined</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res.json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      query,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(&#x27;Search API error:&#x27;, error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res.status(500).json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: &#x27;An error occurred during search&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      message: error.message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// RAG endpoint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.post(&#x27;/api/rag&#x27;, async (req, res) =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const { query, options } = req.body;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!query) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      return res.status(400).json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        error: &#x27;Missing required parameter: query&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const response = await generateResponse(query, options);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res.json(response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(&#x27;RAG API error:&#x27;, error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res.status(500).json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: &#x27;An error occurred during response generation&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      message: error.message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Load and answer test questions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.get(&#x27;/api/test&#x27;, async (req, res) =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const qaFilePath = path.join(__dirname, &#x27;../data/qa-pairs.json&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const qaData = await fs.readJSON(qaFilePath);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const results = [];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for (const qa of qaData) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const response = await generateResponse(qa.question);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      // Check if the expected source appears in the sources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      const foundExpectedSource = response.sources.some(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source =&gt; source.source.includes(qa.expected_source)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      results.push({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        question: qa.question,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        answer: response.answer,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        expected_source: qa.expected_source,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        found_expected_source: foundExpectedSource,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        sources: response.sources</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res.json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      total: qaData.length,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      correct_sources: results.filter(r =&gt; r.found_expected_source).length,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(&#x27;Test API error:&#x27;, error);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res.status(500).json({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: &#x27;An error occurred during test&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      message: error.message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Start the server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const PORT = process.env.PORT || 3000;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">app.listen(PORT, () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`üöÄ RAG application server running on port \${PORT}\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`üìù API Documentation:\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`   - GET  /healthz             Health check\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`   - GET  /api/search?query=X  Vector search\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`   - POST /api/rag              RAG response generation\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  console.log(\`   - GET  /api/test             Run test suite\`);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create a test script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat &lt;&lt;EOL &gt; rag-workshop/tests/app.test.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const request = require(&#x27;supertest&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const app = require(&#x27;../src/index&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">describe(&#x27;RAG Application API&#x27;, () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  it(&#x27;should return OK for health check&#x27;, async () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const res = await request(app).get(&#x27;/healthz&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expect(res.statusCode).toEqual(200);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expect(res.text).toEqual(&#x27;OK&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  it(&#x27;should return search results for a valid query&#x27;, async () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const res = await request(app).get(&#x27;/api/search?query=What%20is%20MongoDB%20Atlas?&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expect(res.statusCode).toEqual(200);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expect(res.body).toHaveProperty(&#x27;results&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  it(&#x27;should return a response for a valid RAG query&#x27;, async () =&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    const res = await request(app)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      .post(&#x27;/api/rag&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      .send({ query: &#x27;What are the security features of MongoDB Atlas?&#x27; });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expect(res.statusCode).toEqual(200);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    expect(res.body).toHaveProperty(&#x27;answer&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo &quot;Project setup complete. Navigate to the &#x27;rag-workshop&#x27; directory and run &#x27;npm install&#x27; to install dependencies.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/mongodb-developer/mongodb-rag/tree/main/mongodb-rag-docs/docs/workshop/50-build-rag-app/5-cheat-script.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mongodb-rag/docs/workshop/build-rag-app/4-integrate-llm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">4 Integrate Llm</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mongodb-rag/docs/workshop/advanced-techniques/1-introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">1 Introduction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#build-script" class="table-of-contents__link toc-highlight">Build Script</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mongodb-rag/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/mongodb-developer/mongodb-rag" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 MongoDB. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>