"use strict";(self.webpackChunkmongodb_rag_docs=self.webpackChunkmongodb_rag_docs||[]).push([[7522],{9947:function(s,e,t){t.r(e),t.d(e,{default:function(){return m}});var a=t(6540),n=t(1163),o=t(5579),r=t(7522),c=t(3081),i=t(2976),l=(t(5531),t(4848));const d=s=>{let{onSelectQuestion:e}=s;const[t,n]=(0,a.useState)(!0);return t?(0,l.jsxs)("div",{className:"sample-questions",children:[(0,l.jsx)("div",{className:"sample-questions-label",children:"Suggested questions:"}),(0,l.jsx)("div",{className:"sample-questions-buttons",children:["How do I configure MongoDB RAG with Ollama?","What's the difference between OpenAI and Ollama embeddings?","Can you fix my config file structure?","How do I troubleshoot connection issues?"].map(((s,t)=>(0,l.jsx)("button",{onClick:()=>(s=>{e(s),n(!1)})(s),className:"sample-question-button",children:s},t)))})]}):null};function u(){const[s,e]=(0,a.useState)([{role:"assistant",content:"Hi! I'm the MongoDB-RAG chatbot. Ask me anything about using MongoDB-RAG!"}]),[t,n]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[j,x]=(0,a.useState)(!0),b=(0,a.useRef)(null),p=(0,a.useRef)(null);(0,a.useEffect)((()=>{b.current?.scrollIntoView({behavior:"smooth"})}),[s]),(0,a.useEffect)((()=>{p.current?.focus()}),[]),(0,a.useEffect)((()=>{const s=localStorage.getItem("mongodbRagChatSession");if(s)try{const{sid:t,msgs:a}=JSON.parse(s);t&&Array.isArray(a)&&(g(t),e(a))}catch(t){console.error("Error loading saved session",t)}}),[]),(0,a.useEffect)((()=>{h&&localStorage.setItem("mongodbRagChatSession",JSON.stringify({sid:h,msgs:s}))}),[h,s]);return(0,l.jsxs)("div",{className:"chatbot-container",children:[(0,l.jsx)("div",{className:"messages-area",children:(0,l.jsxs)("div",{className:"messages-container",children:[s.map(((s,e)=>(0,l.jsxs)("div",{className:`message ${s.role}`,children:[(0,l.jsx)("div",{className:"message-avatar",children:"assistant"===s.role?" \ud83e\udd89":"\ud83d\udc64"}),(0,l.jsx)("div",{className:"message-content",children:"assistant"===s.role?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.oz,{rehypePlugins:[r.A,c.A],remarkPlugins:[i.A],children:s.content}),s.sources&&s.sources.length>0&&(0,l.jsx)("div",{className:"sources",children:(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Sources"}),(0,l.jsx)("ul",{children:s.sources.map(((s,e)=>(0,l.jsxs)("li",{children:[s.metadata?.title||"Document",(0,l.jsxs)("span",{className:"score",children:[Math.round(100*s.score),"% match"]})]},e)))})]})})]}):(0,l.jsx)("div",{children:s.content})})]},e))),u&&(0,l.jsxs)("div",{className:"message assistant",children:[(0,l.jsx)("div",{className:"message-avatar",children:"\ud83e\udd89"}),(0,l.jsx)("div",{className:"message-content",children:(0,l.jsxs)("div",{className:"loading-indicator",children:[(0,l.jsx)("span",{}),(0,l.jsx)("span",{}),(0,l.jsx)("span",{})]})})]}),(0,l.jsx)("div",{ref:b})]})}),(0,l.jsx)("div",{className:"input-area",children:(0,l.jsxs)("div",{className:"input-container",children:[(0,l.jsx)("button",{onClick:()=>{e([{role:"assistant",content:"Hi! I'm the MongoDB-RAG chatbot. Ask me anything about using MongoDB-RAG!"}]),g(null),localStorage.removeItem("mongodbRagChatSession"),n(""),x(!0),p.current?.focus()},className:"clear-button",children:"Clear Chat"}),j&&(0,l.jsx)(d,{onSelectQuestion:s=>{n(s),x(!1),p.current?.focus()}}),(0,l.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),!t.trim())return;const o={role:"user",content:t};e((s=>[...s,o])),n(""),m(!0),x(!0);try{const a=await fetch("https://mongodb-rag-docs-backend.vercel.app/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,sessionId:h,history:h?void 0:s})}),n=await a.json();n.sessionId&&!h&&g(n.sessionId),e((s=>[...s,{role:"assistant",content:n.answer,sources:n.sources}]))}catch(r){console.error("Error:",r),e((s=>[...s,{role:"assistant",content:"Sorry, I encountered an error. Please try again later."}]))}finally{m(!1)}},className:"input-form",children:[(0,l.jsx)("input",{ref:p,type:"text",value:t,onChange:s=>{const e=s.target.value;n(e),x(0===e.length)},placeholder:"Ask about MongoDB-RAG...",className:"chat-input",disabled:u}),(0,l.jsx)("button",{type:"submit",className:"send-button",disabled:u||!t.trim(),children:"Send"})]})]})})]})}function m(){return(0,l.jsx)(n.A,{title:"MongoDB-RAG Chatbot",description:"Ask questions about MongoDB-RAG and get instant answers",wrapperClassName:"chatbot-page-layout",children:(0,l.jsxs)("div",{className:"chatbot-page",children:[(0,l.jsx)(u,{}),(0,l.jsx)("div",{className:"beta-badge",children:"Beta"})]})})}}}]);